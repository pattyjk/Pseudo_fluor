scale_fill_manual(values = c('#f58231', '#4363d8'))
ggplot(eco_m, aes(Carbon2, value, fill=Type))+
coord_flip()+
theme_bw()+
geom_boxplot()+
scale_fill_manual(values = c('#f58231', '#4363d8'))
inhibitory<-read.delim("Bullfrog-nutrient-enrichment/bullfrog_out.txt", header=F)
#read in results from vsearch clustering against AmphiBac database
inhibitory<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/bullfrog_out.txt", header=F)
asv_table <- read.delim("~/GitHub/Bullfrog-nutrient-enrichment/asv_table.txt", row.names=1, header=T)
meta<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/nut_enrich_16S_map.txt", header=T)
#filter out chloroplast/mitochondria
asv_table<-asv_table[-which(row.names(asv_table)=='180ed1cd4fafc390ffc300108ccf648e' | row.names(asv_table)=='7827defa226f025727dd0d1866cb5bba' | row.names(asv_table)=='94fc02cb626b227105e3b90cc5900802'),]
#rarefy table
asv_table<-rrarefy(t(asv_table), sample=2573)
asv_table<-as.data.frame(t(asv_table))
#subset ASV table to only include ASVs that amtch database
inhib_tb<-asv_table[row.names(asv_table) %in% inhibitory$V1,]
#calculate percentage of ASVs that are inhibitory
100*(220/3697)
#5.95%
#calculate colSums for total/inhibitory communities
total_sum<-as.data.frame(colSums(asv_table))
inhib_sum<-as.data.frame(colSums(inhib_tb))
#bind data together
inhib_tb2<-cbind(total_sum, inhib_sum)
#calculate percent inhibitory
inhib_tb2$per_inhib<-inhib_tb2$`colSums(inhib_tb)`/inhib_tb2$`colSums(asv_table)`
#add column for SampleID and merge metadata
inhib_tb2$SampleID<-row.names(inhib_tb2)
inhib_tb2<-merge(inhib_tb2, meta, by='SampleID')
inhib_tb2$per_inhib2<-inhib_tb2$per_inhib*100
#plot per species
library(ggplot2)
ggplot(inhib_tb2[-which(inhib_tb2$per_inhib2>50),], aes(Type, per_inhib2, fill=Type))+
geom_jitter()+
geom_boxplot()+
theme_bw()+
xlab("")+
coord_flip()+
scale_fill_manual(values = c('#f58231', '#4363d8'))+
ylab("Percent Inhibitory towards Bd")
#calculate stats
TukeyHSD(aov(inhib_tb2$per_inhib ~inhib_tb2$Type))
library(vegan)
library(ggplot2)
library(ggpubr)
library(plyr)
library(dplyr)
library(reshape2)
library(RColorBrewer)
#read in metadata and asv table
asv_table <- read.delim("~/GitHub/Bullfrog-nutrient-enrichment/asv_table.txt", row.names=1, header=T)
meta<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/nut_enrich_16S_map.txt", header=T)
#filter out chloroplast/mitochondria
asv_table<-asv_table[-which(row.names(asv_table)=='180ed1cd4fafc390ffc300108ccf648e' | row.names(asv_table)=='7827defa226f025727dd0d1866cb5bba' | row.names(asv_table)=='94fc02cb626b227105e3b90cc5900802'),]
#look at sequenceing depth
colSums(asv_table)
#2573 is the lowest good depth, lose only 3 samples
#rarefy data
nut_rare<-rrarefy(t(asv_table), sample=2573)
#calculate PCoA based on BC similarity
ko_pcoa<-capscale(nut_rare  ~ 1, distance='bray')
#pull out x/y coordinates
ko.scores<-scores(ko_pcoa)
#grab only sample coordinates, write to data frame
ko.coords<-as.data.frame(ko.scores$sites)
#create sample names as a column
ko.coords$SampleID<-row.names(ko.coords)
#map back meta data
ko.coords<-merge(ko.coords, meta, by.x='SampleID', by.y='SampleID')
#calculate percent variation explained for first two axis
100*round(ko_pcoa$CA$eig[1]/sum(ko_pcoa$CA$eig), 3)
#20.4
100*round(ko_pcoa$CA$eig[2]/sum(ko_pcoa$CA$eig), 3)
#12.2
#plot PCoA
ggplot(ko.coords, aes(MDS1, MDS2, color=Type))+
geom_point(aes(size=2))+
#geom_text()+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
guides(alpha = "none")+
xlab("PC1- 20.4%")+
ylab("PC2- 12.2%")
ggplot(ko.coords, aes(MDS1, LogBd))+
geom_point(aes(size=2))+
#geom_text()+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
guides(alpha = "none")+
xlab("Axis 1 values")+
ylab("Log Bd ITS")+
geom_smooth(method='lm')+
stat_cor(method = "spearman", cor.coef.name="rho")
nut_enrich_asv_table<- read.delim("~/GitHub/Bullfrog-nutrient-enrichment/asv_table.txt", row.names=1, header=T)
meta<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/nut_enrich_16S_map.txt", header=T)
#CALCULATE RICHNESS & add metadata & statistics
larv.alph<-as.data.frame(specnumber(rrarefy(t(nut_enrich_asv_table), sample=3000)))
larv.alph$SampleID<-row.names(larv.alph)
larv.alph<-merge(larv.alph, meta, by='SampleID')
larv.alph$Richness<-as.numeric(larv.alph$`specnumber(rrarefy(t(nut_enrich_asv_table), sample = 3000))`)
t.test(larv.alph$Richness, larv.alph$Type2)
larv.alpha2<-as.data.frame(diversity(rrarefy(t(nut_enrich_asv_table), sample=3000), index = 'shannon'))
larv.alpha2<-as.data.frame(vegan::diversity(rrarefy(t(nut_enrich_asv_table), sample=3000), index = 'shannon'))
names(larv.alpha2)<-"Shannon"
larv.alph<-cbind(larv.alph, larv.alpha2)
#plot richness
ggplot(larv.alph, aes(Type, Richness, fill=Type))+
geom_jitter()+
geom_boxplot()+
theme_bw()+
xlab("")+
coord_flip()+
ylab("sOTU Richness")+
scale_fill_manual(values = c('#f58231', '#4363d8'))
ggplot(larv.alph, aes(Type, Shannon, fill=Type))+
geom_jitter()+
geom_boxplot()+
theme_bw()+
xlab("")+
coord_flip()+
ylab("Shannon Diversity")+
scale_fill_manual(values = c('#f58231', '#4363d8'))
t.test(larv.alph$Shannon, larv.alph$Type2)
#plot Bd load between pond type
ggplot(larv.alph, aes(Type, Bd_load, fill=Type))+
geom_jitter()+
geom_boxplot()+
theme_bw()+
xlab("")+
coord_flip()+
scale_y_log10()+
ylab("Log Bd ITS Copy Number")+
scale_fill_manual(values = c('#f58231', '#4363d8'))
ggplot(larv.alph, aes(Bd_load, Richness, color=Type))+
geom_point()+
theme_bw()+
xlab("")+
coord_flip()+
xlab("sOTU richness")+
ylab("Log Bd ITS Copy Number")+
scale_color_manual(values = c('#f58231', '#4363d8'))
#plot richness as function of Bd load
ggplot(larv.alph, aes(Bd_load, Richness, color=Type))+
geom_point()+
theme_bw()+
xlab("")+
coord_flip()+
xlab("sOTU richness")+
ylab("Log Bd ITS Copy Number")+
scale_color_manual(values = c('#f58231', '#4363d8'))+
stat_cor(method = "spearman", cor.coef.name="rho")
#plot richness as function of Bd load
ggplot(larv.alph, aes(Bd_load, Richness, color=Type))+
geom_point()+
theme_bw()+
xlab("")+
xlab("sOTU richness")+
ylab("Log Bd ITS Copy Number")+
scale_color_manual(values = c('#f58231', '#4363d8'))+
stat_cor(method = "spearman", cor.coef.name="rho")
#plot richness as function of Bd load
ggplot(larv.alph, aes(Richness, Bd_load, color=Type))+
geom_point()+
theme_bw()+
xlab("")+
xlab("sOTU richness")+
ylab("Log Bd ITS Copy Number")+
scale_color_manual(values = c('#f58231', '#4363d8'))+
stat_cor(method = "spearman", cor.coef.name="rho")
ggplot(larv.alph, aes(Richness, Bd_load, color=Type))+
geom_point()+
theme_bw()+
xlab("")+
xlab("sOTU richness")+
ylab("Log Bd ITS Copy Number")+
scale_color_manual(values = c('#f58231', '#4363d8'))+
stat_cor(method = "spearman", cor.coef.name="rho")
ggplot(inhib_tb2[-which(inhib_tb2$per_inhib2>50),], aes(Type, per_inhib2, fill=Type))+
geom_jitter()+
geom_boxplot()+
theme_bw()+
xlab("")+
coord_flip()+
scale_fill_manual(values = c('#f58231', '#4363d8'))+
ylab("Percent Inhibitory towards Bd")
#calculate stats
TukeyHSD(aov(inhib_tb2[-which(inhib_tb2$per_inhib2>50),]$per_inhib ~inhib_tb2$Type))
asv_table <- read.delim("~/GitHub/Bullfrog-nutrient-enrichment/asv_table.txt", row.names=1, header=T)
meta<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/nut_enrich_16S_map.txt", header=T)
#filter out chloroplast/mitochondria
asv_table<-asv_table[-which(row.names(asv_table)=='180ed1cd4fafc390ffc300108ccf648e' | row.names(asv_table)=='7827defa226f025727dd0d1866cb5bba' | row.names(asv_table)=='94fc02cb626b227105e3b90cc5900802'),]
#rarefy table
asv_table<-rrarefy(t(asv_table), sample=2573)
asv_table<-as.data.frame(t(asv_table))
#add ASV names as a column
asv_table$OTU<-row.names(asv_table)
#reshape table for calculation
asv_m<-melt(asv_table)
#add metadata
asv_m<-merge(asv_m, meta, by.x='variable', by.y='SampleID')
asv_m<-asv_m[,c(2,3,6)]
#calculate kruskal-wallis to ID differential abundant taxa with Benjamini-hochberg corrected p-value
library(ggpubr)
kruskal_results<-as.data.frame(compare_means(value ~ Type, group.by = 'OTU', p.adjust.method='BH', method = 'kruskal.test', data=asv_m))
length(which(kruskal_results$p.adj<0.01))
#100 differentialyl abundant OTUs becuase of N-enrichment
#read in taxonomy data for each OTU & append to Kruskal-wallis results
tax<-read.delim("Bullfrog-nutrient-enrichment/taxonomy.tsv", header=T)
tax<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/taxonomy.tsv", header=T)
kruskal_results<-merge(kruskal_results, tax, by.x='OTU', by.y='Feature.ID', all.y=F)
#create a table of only significant OTUs
sig_krusk<-kruskal_results[which(kruskal_results$p.adj<0.01),]
#calculate average abundance of each OTU for n-enrichment/reference sites
library(plyr)
asv_means<-ddply(asv_m, c("OTU", 'Type'), summarize, mean=mean(value), sd=sd(value), n=length(value), se=sd/n)
#add averages to significant kruskal wallis results
sig_krusk<-merge(sig_krusk, asv_means, by.x='OTU', by.y='OTU', all.y=F)
#change to relative abundance
sig_krusk$rel_abun<-10*(sig_krusk$mean/2573)
#split taxonomy
library(stringi)
library(tidyr)
sig_krusk<-separate(sig_krusk, Taxon, sep=';', , into=c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species"))
#plot mean abundance
ggplot(sig_krusk, aes(Genus, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()
str(asv_m)
View(sig_krusk)
?compare_means
kruskal_results<-as.data.frame(compare_means(value ~ Type, group.by = 'OTU', p.adjust.method='BH', method = 'fdr', data=asv_m))
kruskal_results<-as.data.frame(compare_means(value ~ Type, group.by = 'OTU', p.adjust.method='fdr', method = 'kruskal.test', data=asv_m))
length(which(kruskal_results$p.adj<0.01))
View(kruskal_results)
tax<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/taxonomy.tsv", header=T)
kruskal_results<-merge(kruskal_results, tax, by.x='OTU', by.y='Feature.ID', all.y=F)
#create a table of only significant OTUs
sig_krusk<-kruskal_results[which(kruskal_results$p.adj<0.01),]
kruskal_results<-as.data.frame(compare_means(value ~ Type, group.by = 'OTU', p.adjust.method='bonferroni', method = 'kruskal.test', data=asv_m))
length(which(kruskal_results$p.adj<0.01))
kruskal_results<-as.data.frame(compare_means(value ~ Type, group.by = 'OTU', p.adjust.method='hochberg', method = 'kruskal.test', data=asv_m))
length(which(kruskal_results$p.adj<0.01))
kruskal_results<-as.data.frame(compare_means(value ~ Type, group.by = 'OTU', p.adjust.method='fdr', method = 'kruskal.test', data=asv_m))
length(which(kruskal_results$p.adj<0.01))
tax<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/taxonomy.tsv", header=T)
kruskal_results<-merge(kruskal_results, tax, by.x='OTU', by.y='Feature.ID', all.y=F)
sig_krusk<-kruskal_results[which(kruskal_results$p.adj<0.01),]
library(plyr)
library(stringi)
library(tidyr)
#add and split taxonomy for Kruskal-Wallis test
sig_krusk<-separate(sig_krusk, Taxon, sep=';', , into=c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species"))
#calculate average abundance of each  for n-enrichment/reference sites
asv_means<-ddply(asv_m, c("OTU", 'Type'), summarize, mean=mean(value), sd=sd(value), n=length(value), se=sd/n)
#add averages to significant kruskal wallis results
sig_krusk<-merge(sig_krusk, asv_means, by.x='OTU', by.y='OTU', all.y=F)
#change to relative abundance
sig_krusk$rel_abun<-10*(sig_krusk$mean/2573)
#plot mean abundance
ggplot(sig_krusk, aes(Genus, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")
sig_krusk$se2<-10*sig_krusk$se
#plot mean abundance
ggplot(sig_krusk, aes(Genus, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")
geom_errorbar(aes(ymin=mean-se2, ymax=mean+se2, colour=Type), width=.2)
#plot mean abundance
ggplot(sig_krusk, aes(Genus, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")+
geom_errorbar(aes(ymin=mean-se2, ymax=mean+se2, colour=Type), width=.2)
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")+
geom_errorbar(aes(ymin=mean-se2, ymax=mean+se2, colour=Type), width=.2)
asv_table <- read.delim("~/GitHub/Bullfrog-nutrient-enrichment/asv_table.txt", row.names=1, header=T)
meta<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/nut_enrich_16S_map.txt", header=T)
#filter out chloroplast/mitochondria
asv_table<-asv_table[-which(row.names(asv_table)=='180ed1cd4fafc390ffc300108ccf648e' | row.names(asv_table)=='7827defa226f025727dd0d1866cb5bba' | row.names(asv_table)=='94fc02cb626b227105e3b90cc5900802'),]
#rarefy table
asv_table<-rrarefy(t(asv_table), sample=2573)
asv_table<-as.data.frame(t(asv_table))
#add ASV names as a column
asv_table$OTU<-row.names(asv_table)
#reshape table for calculation
asv_m<-melt(asv_table)
#add metadata
asv_m<-merge(asv_m, meta, by.x='variable', by.y='SampleID')
asv_m<-asv_m[,c(2,3,6)]
#calculate kruskal-wallis to ID differential abundant taxa with Benjamini-hochberg corrected p-value
library(ggpubr)
kruskal_results<-as.data.frame(compare_means(value ~ Type, group.by = 'OTU', p.adjust.method='fdr', method = 'kruskal.test', data=asv_m))
length(which(kruskal_results$p.adj<0.01))
#82 differentially abundant OTUs because of N-enrichment
#read in taxonomy data for each OTU & append to Kruskal-wallis results
tax<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/taxonomy.tsv", header=T)
kruskal_results<-merge(kruskal_results, tax, by.x='OTU', by.y='Feature.ID', all.y=F)
#create a table of only significant OTUs
sig_krusk<-kruskal_results[which(kruskal_results$p.adj<0.01),]
library(plyr)
library(stringi)
library(tidyr)
#add and split taxonomy for Kruskal-Wallis test
sig_krusk<-separate(sig_krusk, Taxon, sep=';', , into=c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species"))
#calculate average abundance of each  for n-enrichment/reference sites
asv_means<-ddply(asv_m, c("OTU", 'Type'), summarize, mean=mean(value), sd=sd(value), n=length(value), se=sd/n)
#add averages to significant kruskal wallis results
sig_krusk<-merge(sig_krusk, asv_means, by.x='OTU', by.y='OTU', all.y=F)
#change to relative abundance
sig_krusk$rel_abun<-10*(sig_krusk$mean/2573)
sig_krusk$se2<-10*sig_krusk$se
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")+
geom_errorbar(aes(ymin=mean-se2, ymax=mean+se2, colour=Type), width=.2)
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se2, ymax=rel_abun+se2, colour=Type), width=.2)
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se, ymax=rel_abun+se, colour=Type), width=.2)
sig_krusk$se2<-sig_krusk$se/10
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se, ymax=rel_abun+se, colour=Type), width=.2)
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se2, ymax=rel_abun+se2, colour=Type), width=.2)
#reorder table by abundance
sig_krusk<-sig_krusk[order(sig_krusk$rel_abun),]
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se2, ymax=rel_abun+se2, colour=Type), width=.2)
#plot mean abundance
ggplot(sig_krusk[order(sig_krusk$rel_abun),], aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se2, ymax=rel_abun+se2, colour=Type), width=.2)
sig_krusk <- sig_krusk %>%
count(OTU, wt=rel_abun) %>%
arrange(disc(rel_abun)) %>%
pull(OTU)
sig_krusk <- sig_krusk %>%
count(OTU, wt=rel_abun) %>%
arrange(disc(rel_abun)) %>%
pull(OTU)
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
facet_wrap(~Phylum)+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se2, ymax=rel_abun+se2, colour=Type), width=.2)
write.table(sig_krusk, 'sig_krusk.txt', row.names=F, sep='\t', quote=F)
sig_krusk<-read.table("~/GitHub/Bullfrog-nutrient-enrichment/sig_krusk.txt", header=T)
sig_krusk <- read.delim("~/GitHub/Bullfrog-nutrient-enrichment/sig_krusk.txt")
View(sig_krusk)
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
facet_wrap(~Phylum)+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se2, ymax=rel_abun+se2, colour=Type), width=.2)
#plot mean abundance
ggplot(sig_krusk, aes(OTU, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
#facet_wrap(~Phylum)+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se2, ymax=rel_abun+se2, colour=Type), width=.2)
#plot mean abundance
ggplot(sig_krusk, aes(Genus, rel_abun, color=Type))+
geom_point()+
#facet_wrap(~Phylum)+
scale_color_manual(values = c('#f58231', '#4363d8'))+
theme_bw()+
coord_flip()+
ylab("Relative Abundance")+
#facet_wrap(~Phylum)+
xlab("")+
geom_errorbar(aes(ymin=rel_abun-se2, ymax=rel_abun+se2, colour=Type), width=.2)
ggplot(sig_krusk, aes(Genus, Type, color=rel_abun))+
geom_tile()
ggplot(sig_krusk, aes(Genus, Type, color=rel_abun))+
geom_tile()+
theme_bw()
ggplot(sig_krusk, aes(Genus, Type, color=rel_abun))+
geom_tile()+
theme_bw()+
scale_fill_gradient2(low = "#075AFF",
mid = "#FFFFCC",
high = "#FF0000")
ggplot(sig_krusk, aes(Genus, Type, fill=rel_abun))+
geom_tile()+
theme_bw()+
scale_fill_gradient2(low = "#075AFF", mid = "#FFFFCC", high = "#FF0000")
ggplot(sig_krusk, aes(Genus, Type, fill=rel_abun))+
geom_tile()+
coord_flip()+
theme_bw()+
scale_fill_gradient2(low = "#075AFF", mid = "#FFFFCC", high = "#FF0000")
ggplot(sig_krusk, aes(Genus, Type, fill=rel_abun))+
geom_tile()+
coord_flip()+
xlab("")+
ylab("")+
theme_bw()+
scale_fill_gradient2(low = "#075AFF", mid = "#FFFFCC", high = "#FF0000")
not_norm<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/picrust_no_norm/KO_metagenome_out/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv")
norm<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/picrust_norm/KO_metagenome_out/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv")
copy_no<-not_norm/norm
###############
#picrust data
not_norm<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/picrust_no_norm/KO_metagenome_out/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv", row.names=1)
norm<-read.delim("~/GitHub/Bullfrog-nutrient-enrichment/picrust_norm/KO_metagenome_out/pred_metagenome_unstrat.tsv/pred_metagenome_unstrat.tsv", row.names=1)
copy_no<-not_norm/norm
View(copy_no)
#calculate average
colavgs<-colMeans(copy_no)
View(colavgs)
#calculate average
colavgs<-as.data.frame(colMeans(copy_no))
copy_no<-not_norm/norm
View(not_norm)
which(copy_no=='NaN')
